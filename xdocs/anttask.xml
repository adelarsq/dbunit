<?xml version="1.0" encoding="ISO-8859-1"?>
<document><properties><title>Ant Integration</title></properties><body><section>
      <h3>Ant Integration</h3>
      <h4>Installation</h4>
      The steps required to add the DbUnit task to your system are: 
        <p>1. Add the DbUnit jar to Ant's classpath. </p>
        <p>2. Add a &lt;taskdef&gt; element to your build script as follows: 
          <source><![CDATA[<taskdef name="dbunit" classname="org.dbunit.ant.DbUnitTask"/>]]></source>
        </p>
        <p>3. Use the task in the rest of the buildfile. </p>
      <h3>Usage </h3>
      <p>Executes either a single transaction, or a group of transactions, under 
        the DbUnit database testing framework.</p>
      <h4>Parameters</h4>
      <table border="1">
        <tr> 
          <th>Attribute</th>
          <th>Description</th>
          <th>Required</th>
        </tr>
        <tr> 
          <td>driver</td>
          <td>Class name of the jdbc driver</td>
          <td>Yes</td>
        </tr>
        <tr> 
          <td>url</td>
          <td>Database connection url</td>
          <td>Yes</td>
        </tr>
        <tr> 
          <td>userid</td>
          <td>Database username</td>
          <td>Yes</td>
        </tr>
        <tr> 
          <td>password</td>
          <td>Database password</td>
          <td>Yes</td>
        </tr>
        <tr> 
          <td>schema </td>
          <td>Database schema</td>
          <td>No</td>
        </tr>
        <tr> 
          <td>classpath</td>
          <td>Classpath used to load driver</td>
          <td>No (use system classpath)</td>
        </tr>
        <tr> 
          <td>useQualifiedTableNames</td>
          <td>Set the <a href="properties.html#qualifiedtablenames">qualified table names</a> feature. Defaults to false</td>
          <td>No</td>
        </tr>
        <tr> 
          <td>supportBatchStatement</td>
          <td>Set the <a href="properties.html#batchstatement">batched statement</a> feature. Defaults to false</td>
          <td>No</td>
        </tr>
        <tr> 
          <td>datatypeWarning</td>
          <td>Set the <a href="properties.html#typewarning">data type warning</a> feature. Defaults to true</td>
          <td>No</td>
        </tr>
        <tr> 
          <td>escapePattern</td>
          <td>Set the <a href="properties.html#escapepattern">escape pattern</a> property.</td>
          <td>No</td>
        </tr>
        <tr> 
          <td>datatypeFactory</td>
          <td>Set the <a href="properties.html#typefactory">datatype factory</a> property.</td>
          <td>No</td>
        </tr>
      </table>
      <h4>Parameters specified as nested elements</h4>
      <table cellspadding="0" border="1">
        <tr> 
          <td>classpath</td>
          <td> 
            <p>DbUnit's classpath attribute is a PATH like structure and can also 
              be set via a nested classpath element. It is used to load the JDBC 
              classes.</p>
          </td>
        </tr>
        <tr> 
          <td>operation</td>
          <td> 
            <p>Use nested &lt;operation&gt; elements to specify which DbUnit operation 
              to perform on the particular file. <br></br>
            </p>
            <table border="1">
              <tr> 
                <th>Attribute</th>
                <th>Description</th>
                <th>Required</th>
              </tr>
              <tr> 
                <td>type</td>
                <td>Type of Database operation to perform. Supported types are 
                  UPDATE, INSERT, DELETE, 
                  DELETE_ALL, REFRESH, 
                  CLEAN_INSERT, MSSQL_INSERT,
                  MSSQL_REFRESH, MSSQL_CLEAN_INSERT.</td>
                <td>Yes</td>
              </tr>
              <tr> 
                <td>src</td>
                <td>The xml source upon which the operation is to be performed</td>
                <td>Yes</td>
              </tr>
              <tr> 
                <td>format</td>
                <td>Format type of supplied source file. Possible values are "flat" 
                  or "xml". Defaults to <b>"flat"</b></td>
                <td> 
                  <p>No</p>
                </td>
              </tr>
              <tr> 
                <td>transaction</td>
                <td>Boolean indicating if this operation should be wrapped in a 
                  transaction, ensuring that the entire operation completes or is 
                  rolled back.  This may also dramatically improve performance of 
                  large operations.  Possible values are "true" or "false".
                  Defaults to <b>"false"</b>.</td>
                <td> 
                  <p>No</p>
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr> 
          <td>export</td>
          <td> 
            <p>Use nested &lt;export&gt; operation elements 
              to export the database to the supplied filename. The default operation 
              is to &lt;export&gt; the entire database to 
              the destination filename with the supplied dataset type. You can 
              specify individual tables or queries to
              &lt;export&gt; by nesting them under the &lt;export&gt; 
              step.</p>
            <table width="100%" border="1">
              <tr> 
                <th>Attribute</th>
                <th>Description</th>
                <th>Required</th>
              </tr>
              <tr> 
                <td>dest</td>
                <td>The xml destination filename</td>
                <td>Yes</td>
              </tr>
              <tr> 
                <td>format</td>
                <td>Format type of supplied destination file. Possible values 
                  are "flat", "xml" or "dtd". Defaults 
                  to <b>"flat"</b></td>
                <td>No</td>
              </tr>
              <tr> 
                <td>doctype</td>
                <td>If set and format is "flat", add DOCTYPE declaration referencing specified DTD to exported dataset. The DTD path can be absolute or relative. </td>
                <td>No</td>
              </tr>
            </table>
            <h4>Parameters specified as nested elements </h4>
            <table border="1">
              <tr> 
                <td>table</td>
                <td> 
                  <p>Use nested &lt;table&gt; elements to export 
                    specific tables. </p>
                  <table border="1">
                    <tr> 
                      <th>Attribute</th>
                      <th>Description</th>
                      <th>Required</th>
                    </tr>
                    <tr> 
                      <td>name</td>
                      <td>Name of the database table to export.</td>
                      <td>Yes</td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr> 
                <td>query</td>
                <td> 
                  <p>Use nested <a class="code">&lt;query&gt;</a> elements to export 
                    data according to a sql statement. </p>
                  <table border="1">
                    <tr> 
                      <th>Attribute</th>
                      <th>Description</th>
                      <th>Required</th>
                    </tr>
                    <tr> 
                      <td>name</td>
                      <td>Name to reference the sql statement.</td>
                      <td>Yes</td>
                    </tr>
                    <tr> 
                      <td>sql</td>
                      <td>The sql to execute. You can use either SELECT * from 
                        Mytable or SELECT col1, col4 from MyTable</td>
                      <td>Yes</td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>
        <tr> 
          <td>compare</td>
          <td> 
            <p>Use nested &lt;compare&gt; elements to validate the content of the database against the specified dataset file.
            </p>
            <table border="1">
              <tr> 
                <th>Attribute</th>
                <th>Description</th>
                <th>Required</th>
              </tr>
              <tr> 
                <td>src</td>
                <td>The xml source upon which the comparison is to be performed</td>
                <td>Yes</td>
              </tr>
              <tr> 
                <td>format</td>
                <td>Format type of supplied source file. Possible values are "flat" 
                  or "xml". Defaults to <b>"flat"</b></td>
                <td>No</td>
              </tr>
              <tr> 
                <td>sort</td>
                <td>Sorts tables prior comparison. Defaults to <b>"false".</b></td>
                <td>No</td>
              </tr>
            </table>
            <h4>Parameters specified as nested elements </h4>
            <table border="1">
              <tr> 
                <td>table</td>
                <td> 
                  <p>Use nested &lt;table&gt; elements to compare
                    specific tables. </p>
                  <table border="1">
                    <tr> 
                      <th>Attribute</th>
                      <th>Description</th>
                      <th>Required</th>
                    </tr>
                    <tr> 
                      <td>name</td>
                      <td>Name of the database table to compare.</td>
                      <td>Yes</td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr> 
                <td>query</td>
                <td> 
                  <p>Use nested <a class="code">&lt;query&gt;</a> elements to compare 
                    data according to a sql statement. </p>
                  <table border="1">
                    <tr> 
                      <th>Attribute</th>
                      <th>Description</th>
                      <th>Required</th>
                    </tr>
                    <tr> 
                      <td>name</td>
                      <td>Name of the database table to compare.</td>
                      <td>Yes</td>
                    </tr>
                    <tr> 
                      <td>sql</td>
                      <td>The sql to execute. You can use either SELECT * from 
                        Mytable or SELECT col1, col4 from MyTable</td>
                      <td>Yes</td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
      <h3>Examples</h3>
      <h4>Update operation with specified JDBC driver jar</h4>
	<source><![CDATA[
<dbunit driver="com.vendor.jdbc.Driver"          
	url="jdbc:vendor:mydatabase"          
	userid="user"          
	password="password">
    <classpath>    	
        <pathelement location="/some/jdbc.jar"/>    
    </classpath>    
    <operation type="UPDATE" src="updateFile.xml"/>  
</dbunit>]]></source>        

      <h4>Insert and update operations</h4>
	<source><![CDATA[
<dbunit driver="com.vendor.jdbc.Driver"          
        url="jdbc:vendor:mydatabase"          
        userid="user"          
        password="password">    
    <operation type="INSERT" src="insertFile.xml"/>    
    <operation type="UPDATE" src="updateFile.xml"/>  
</dbunit>]]></source>        

      <h4>Database data export to XML</h4>
	<source><![CDATA[
<dbunit driver="com.vendor.jdbc.Driver"          
        url="jdbc:vendor:mydatabase"          
        userid="user"          
        password="password">    
    <export dest="export.xml"/> 
</dbunit>]]></source>        

      <h4>Database structure export to DTD</h4>
	<source><![CDATA[
<dbunit driver="com.vendor.jdbc.Driver"          
        url="jdbc:vendor:mydatabase"          
        userid="user"          
        password="password">    
    <export dest="export.dtd" format="dtd"/>
</dbunit>]]></source>        

      <h4><a name="partialexport">Partial database data export</a></h4>
      <p>Export two tables: FOO, resulting from specified query and BAR entire content</p>
	<source><![CDATA[
<dbunit driver="com.vendor.jdbc.Driver"          
        url="jdbc:vendor:mydatabase"          
        userid="user"          
        password="password">    
    <export dest="partial.xml">      
        <query name="FOO" sql="SELECT COL1, COL2 FROM FOO WHERE COL1=4"/>
        <table name="BAR"/>      
    </export>
</dbunit>]]></source>        

      <h4>Database data comparison</h4>
	<source><![CDATA[
<dbunit driver="com.vendor.jdbc.Driver"          
        url="jdbc:vendor:mydatabase"          
        userid="user"          
        password="password">    
    <compare src="expectedData.xml"/>    
</dbunit>]]></source>        

      <h4><a name="partialcompare">Partial database data comparison</a></h4>
	<source><![CDATA[
<dbunit driver="com.vendor.jdbc.Driver"          
        url="jdbc:vendor:mydatabase"          
        userid="user"          
        password="password">    
    <compare src="expectedData.xml">      
        <query name="FOO" sql="SELECT COL1, COL2 FROM FOO WHERE COL1=4"/>
        <table name="BAR"/>      
    </compare>
</dbunit>]]></source>        

</section></body></document>